<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="delegate-ch" content="sec-ch-ua https://guirmannurcence.com; sec-ch-ua-mobile https://guirmannurcence.com; sec-ch-ua-arch https://guirmannurcence.com; sec-ch-ua-model https://guirmannurcence.com; sec-ch-ua-platform https://guirmannurcence.com; sec-ch-ua-platform-version https://guirmannurcence.com; sec-ch-ua-bitness https://guirmannurcence.com; sec-ch-ua-full-version-list https://guirmannurcence.com; sec-ch-ua-full-version https://guirmannurcence.com">
    <style>
        .dtpcnt { opacity: 0; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        a { color: #007bff; text-decoration: none; }
        a:hover { text-decoration: underline; }
        pre { white-space: pre-wrap; }
    </style>
    <script>
        (function(c,d,f,h,t,b,n,u,k,l,m,e,p,v,q){function r(a){var c=d.cookie.match(new RegExp("(^| )"+a+"=([^;]+)"));return c?c.pop():f.getItem(a+"-expires")&&+f.getItem(a+"-expires")>(new Date).getTime()?f.getItem(a):null}q="https:"===c.location.protocol?"secure; ":"";c[b]||(c[b]=function(a){c[b].state.callbackQueue.push(a)},c[b].state={callbackQueue:[]},c[b].registerConversion=function(a){c[b].state.callbackQueue.push(a)},function(){(m=/[?&]cpid(=([^&#]*)|&|#|$)/.exec(c.location.href))&&m[2]&&(e=m[2],
p=r("vl-"+e));var a=r("vl-cid"),b;"savedCid"!==u||!a||e&&"undefined"!==typeof e||(b=a);k=d.createElement("script");l=d.scripts[0];k.src=n+(-1===n.indexOf("?")?"?":"&")+"oref="+h(d.referrer)+"&ourl="+h(location[t])+"&opt="+h(d.title)+"&vtm="+(new Date).getTime()+(b?"&cid="+b:"")+(p?"&uw=no":"");l.parentNode.insertBefore(k,l);if(e){a="vl-"+e;b=q;var g=new Date;g.setTime(g.getTime()+864E5);d.cookie=a+"=1; "+b+"samesite=Strict; expires="+g.toGMTString()+"; path=/";f.setItem(a,"1");f.setItem(a+"-expires",
g.getTime())}}())})(window,document,localStorage,encodeURIComponent,"href","dtpCallback","https://guirmannurcence.com/d/.js","savedCid");
    </script>
    <noscript><link href="https://guirmannurcence.com/d/.js?noscript=true&ourl=" rel="stylesheet"/></noscript>
    <title>Offer Buttons</title>
</head>
<body>
    <h1>Available Offers</h1>
    <table id="offers-table">
        <thead>
            <tr>
                <th>Offer</th>
                <th>Full URL</th>
                <th>Offer Parameters</th>
                <th>Visitor Tokens</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <script>
        dtpCallback((params) => {
            const tableBody = document.querySelector('#offers-table tbody');
            const maxOffers = 50;
            const tokens = dtpCallback.getTokens();
            const createdLinks = [];

            // Generate links for up to 50 offers
            for (let index = 0; index < maxOffers; index++) {
                const offerNum = index === 0 ? '' : `/${index + 1}`;
                const originalHref = `https://guirmannurcence.com/click${offerNum}`;
                const row = document.createElement('tr');
                const offerCell = document.createElement('td');
                const a = document.createElement('a');
                a.href = originalHref;
                a.textContent = `Offer ${offerNum || 'default'}`;
                offerCell.appendChild(a);
                row.appendChild(offerCell);
                tableBody.appendChild(row);
                createdLinks.push({ row, originalHref, a, offerCell, index });
            }

            // Call generateLinks and wait briefly to ensure links are updated
            dtpCallback.generateLinks();

            setTimeout(() => {
                createdLinks.forEach(({ row, originalHref, a, offerCell, index }) => {
                    // Check if the link was updated by generateLinks
                    if (a.href === originalHref || a.href.includes('/click')) {
                        tableBody.removeChild(row); // Remove rows with invalid/unchanged links
                    } else {
                        // Register click event
                        a.addEventListener('click', () => {
                            dtpCallback.registerClick(index);
                        });

                        // Add full URL
                        const urlCell = document.createElement('td');
                        urlCell.textContent = a.href;
                        row.appendChild(urlCell);

                        // Extract and display offer parameters
                        const params = {};
                        const url = new URL(a.href);
                        for (let [key, value] of url.searchParams.entries()) {
                            params[key] = value;
                        }
                        const paramsCell = document.createElement('td');
                        paramsCell.innerHTML = `<pre>${JSON.stringify(params, null, 2)}</pre>`;
                        row.appendChild(paramsCell);

                        // Display visitor tokens
                        const tokensCell = document.createElement('td');
                        tokensCell.innerHTML = `<pre>${JSON.stringify(tokens, null, 2)}</pre>`;
                        row.appendChild(tokensCell);
                    }
                });

                // If no rows are left, display a message
                if (tableBody.children.length === 0) {
                    const row = document.createElement('tr');
                    const cell = document.createElement('td');
                    cell.colSpan = 4;
                    cell.textContent = 'No valid offers available.';
                    row.appendChild(cell);
                    tableBody.appendChild(row);
                }
            }, 100); // Small delay to ensure generateLinks completes
        });
    </script>
</body>
</html>
