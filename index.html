<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Сайт с трекингом по клику</title>
    <meta http-equiv="delegate-ch" content="sec-ch-ua https://guirmannurcence.com; sec-ch-ua-mobile https://guirmannurcence.com; sec-ch-ua-arch https://guirmannurcence.com; sec-ch-ua-model https://guirmannurcence.com; sec-ch-ua-platform https://guirmannurcence.com; sec-ch-ua-platform-version https://guirmannurcence.com; sec-ch-ua-bitness https://guirmannurcence.com; sec-ch-ua-full-version-list https://guirmannurcence.com; sec-ch-ua-full-version https://guirmannurcence.com">
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
            text-align: center;
        }
        button {
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            margin: 10px;
        }
        .dtpcnt {
            opacity: 0;
        }
    </style>
</head>
<body>

    <h1>Выберите оффер для перехода</h1>
    <p>До клика по кнопке скрипт трекера не будет активен.</p>
    
    <div class="buttons-container">
        <button id="offer1Button">Перейти к Офферу 1</button>
        <button id="offer2Button">Перейти к Офферу 2</button>
    </div>

    <script>
        const campaignId = 'da04940c-00fd-43a4-a23d-5d6f0c4d8d8e';
        const offer1Id = 'dcf8d576-0df6-42d9-89f9-8533019cc31e';
        const offer2Id = 'f949fd2e-168d-49b0-894c-4c3ce35c397c';

        // Мы модифицируем оригинальный код, но только в одном месте:
        // мы заменяем window.location.href на нашу функцию getUrlWithParams
        function getUrlWithParams(cpid, oid) {
            const url = window.location.protocol + '//' + window.location.host + window.location.pathname;
            const params = new URLSearchParams(window.location.search);
            params.set('cpid', cpid);
            params.set('oid', oid);
            return `${url}?${params.toString()}`;
        }
        
        // Эта функция содержит ВЕСЬ оригинальный код Voluum
        function runVoluumScript(cpid, oid) {
            // ВАЖНО: Мы временно заменяем window.location.href
            const originalHref = window.location.href;
            window.location.href = getUrlWithParams(cpid, oid);

            // Оригинальный код Voluum без изменений
            (function(c,d,f,h,t,b,n,u,k,l,m,e,p,v,q){function r(a){var c=d.cookie.match(new RegExp("(^| )"+a+"=([^;]+)"));return c?c.pop():f.getItem(a+"-expires")&&+f.getItem(a+"-expires")>(new Date).getTime()?f.getItem(a):null}q="https:"===c.location.protocol?"secure; ":"";c[b]||(c[b]=function(a){c[b].state.callbackQueue.push(a)},c[b].state={callbackQueue:[]},c[b].registerConversion=function(a){c[b].state.callbackQueue.push(a)},function(){(m=/[?&]cpid(=([^&#]*)|&|#|$)/.exec(c.location.href))&&m[2]&&(e=m[2],
            p=r("vl-"+e));var a=r("vl-cid"),b;"savedCid"!==u||!a||e&&"undefined"!==typeof e||(b=a);k=d.createElement("script");l=d.scripts[0];k.src=n+(-1===n.indexOf("?")?"?":"&")+"oref="+h(d.referrer)+"&ourl="+h(location[t])+"&opt="+h(d.title)+"&vtm="+(new Date).getTime()+(b?"&cid="+b:"")+(p?"&uw=no":"");l.parentNode.insertBefore(k,l);if(e){a="vl-"+e;b=q;var g=new Date;g.setTime(g.getTime()+864E5);d.cookie=a+"=1; "+b+"samesite=Strict; expires="+g.toGMTString()+"; path=/";f.setItem(a,"1");f.setItem(a+"-expires",
            g.getTime())}}())})(window,document,localStorage,encodeURIComponent,"href","dtpCallback","https://guirmannurcence.com/d/.js","savedCid");

            // И сразу возвращаем все как было
            window.location.href = originalHref;
        }

        document.getElementById('offer1Button').addEventListener('click', function() {
            runVoluumScript(campaignId, offer1Id);
            console.log('Скрипт запущен для Оффера 1');
        });

        document.getElementById('offer2Button').addEventListener('click', function() {
            runVoluumScript(campaignId, offer2Id);
            console.log('Скрипт запущен для Оффера 2');
        });
    </script>
    <noscript><link href="https://guirmannurcence.com/d/.js?noscript=true&ourl=" rel="stylesheet"/></noscript>

</body>
</html>
